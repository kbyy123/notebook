# 重积分
## 二重积分
### 理解
在单变量积分中，我们可以将定积分 $\displaystyle\int_a^b f(x) dx$ 看作函数 $y=f(x)$ 在区间 $[a,b]$ 上与 $x$ 轴围成的面积．在二重积分中，我们可以将 $\displaystyle\iint_R f(x,y)\, dA$ 看作函数 $z=f(x,y)$ 在区域 $R$ 上与 $xy$ 平面围成的体积；但如果用这种理解方式就难以形象理解三重积分，因此我们可以将 $f(x,y)$ 看作一个“密度”，二重积分就是求区域 $R$ 的总面质量．

### 计算
#### 直角坐标
对于给定的区域 $R$，如果采用直角坐标系，面积微元可以用矩形近似，即 $dA = dx\, dy$；
我们可以先固定住 $x$，求出在 $x$ 给定的情况下 $y$ 的积分，即 $S(x) = \displaystyle\int f(x,y)dy$；
再对 $x$ 进行积分，得到 $\displaystyle\iint_R f(x,y)\, dxdy=\int_{x_{min}}^{x_{max}} S(x) dx$，即
$$
\iint_R f(x,y)\, dxdy=\int_{x_{min}}^{x_{max}} \left( \int_{y_{min}}^{y_{max}} f(x,y) dy \right) dx
$$
将二重积分转化为二次积分．

例1：计算 $\displaystyle\iint_R (1 -x^2 - y^2) dA$，其中 $R$ 是 $0 \le x \le 1, 0 \le y \le 1$ 围成的区域．
$$
\begin{aligned}
\iint_R (1 -x^2 - y^2) dA &= \int_0^1 \left( \int_0^1 (1 -x^2 - y^2) dy \right) dx \\
&= \int_0^1 \left[ y - x^2 y - \frac{y^3}{3} \right]_0^1 dx \\
&= \int_0^1 \left(1 - x^2 - \frac{1}{3} \right) dx \\
&= \int_0^1 \left( \frac{2}{3} - x^2\right) dx \\
&= \left[ \frac{2}{3}x - \frac{x^3}{3} \right]_0^1 \\
&= \frac{1}{3}.
\end{aligned}
$$
例2：计算 $\displaystyle\iint_R (1 - x^2 - y^2) dA$，其中 $R$ 是 $x^2 + y^2 \le 1$ 在第一象限围成的区域．
$$
\begin{aligned}
\iint_R (1 - x^2 - y^2) dA &= \int_{0}^1 \left( \int_{0}^{\sqrt{1-x^2}} (1 - x^2 - y^2) dy \right) dx \\
&= \int_{0}^1 \left[ y - x^2 y - \frac{y^3}{3} \right]_0^{\sqrt{1-x^2}} dx \\
&= \int_{0}^1 \left[ \sqrt{1-x^2} - x^2 \sqrt{1-x^2} - \frac{(1-x^2)^{\frac{3}{2}}}{3} \right] dx \\
&=\frac{2}{3} \int_{0}^1 (1-x^2)^{\frac{3}{2}} dx \\
\end{aligned}
$$
令 $x=\sin{\theta}$，则
$$
\begin{aligned}
\frac{2}{3}\int_0^1(1-x^2)^{\frac{3}{2}} dx &=
\frac{2}{3}\int_0^{\frac{\pi}{2}}
\cos ^3\theta \, d\sin \theta \\
&= \frac{2}{3}\int_0^{\frac{\pi}{2}}\cos ^4\theta\, d\theta \\
&= \frac{2}{3} \cdot \frac{3}{4} \cdot \frac{1}{2} \cdot \ \frac{\pi}{2}\\
&= \frac{\pi}{8}.
\end{aligned}
$$
例3：计算 $\displaystyle\int_0^1 \int_x^{\sqrt x}\frac{e^y}{y}dy\, dx$．

由于内部积分积不出，我们可以利用二重积分对 $x,y$ 积分顺序不影响结果的性质，交换积分顺序．
![](assets/file-20260224110825501.png)
积分区域为 $y=x$ 与 $y=\sqrt x$ 在 $x=0$ 和 $x=1$ 围成的区域．交换积分顺序后，积分区域为 $x=y^2$ 与 $x=y$ 在 $y=0$ 和 $y=1$ 围成的区域．因此
$$
\begin{aligned}
\int_0^1 \int_x^{\sqrt x}\frac{e^y}{y}dy\, dx &=
\int_0^1 \int_{y^2}^{y} \frac{e^y}{y} dx\, dy \\
&= \int_0^1 \frac{e^y}{y}(y-y^2) dy \\
&= \int_0^1 e^y (1-y) dy \\
&= \left[ -ye^y+2e^y \right]_0^1 \\
&= e - 2.
\end{aligned}
$$

#### 极坐标
上述例2中，积分区域 $R$ 是一个圆，含有圆的积分通常可以使用极坐标计算化简．
![](assets/file-20260224111242440.png)
如图所示，在极坐标中，面积微元 $\Delta A$ 在 $\Delta r$ 和 $\Delta \theta$ 足够小时可近似看作矩形，长宽分别为 $r\Delta \theta$ 和 $\Delta r$，取极限 $\Delta r,\Delta \theta \to 0$，得到 $dA = r\, dr\, d\theta$．

一般来说，使用极坐标计算二重积分时先对 $r$ 积分，因为 $r$ 一般是被 $\theta$ 表示的，对于给定的 $\theta$，$r\in [r_{min}, r_{max}]$；再对 $\theta$ 积分，$\theta \in [\theta_{min}, \theta_{max}]$；$\theta$ 的取值范围一般是常数区间，如 $[0,\dfrac{\pi}{2}]$ 或 $[0,2\pi]$ 等．  

由此，例2中二重积分的计算可以化简为
$$
\begin{aligned}
\iint_R (1 - x^2 - y^2) dA &= \int_0^{\frac{\pi}{2}} \int_0^1 (1 - r^2) r\, dr\, d\theta \\
&= \int_0^{\frac{\pi}{2}} \left[ \frac{r^2}{2} - \frac{r^4}{4} \right]_0^1 d\theta \\
&= \int_0^{\frac{\pi}{2}} \frac{1}{4} d\theta \\
&= \frac{\pi}{8}.
\end{aligned}
$$

#### 任意换元
例1：计算 $\displaystyle\iint_R dx\, dy$，其中 $R$ 是椭圆 $\dfrac{x^2}{a^2} + \dfrac{y^2}{b^2} \le 1$ 围成的区域．

我们能很自然地想到令 $u = \dfrac{x}{a}, v = \dfrac{y}{b}$，则椭圆变为单位圆 $u^2 + v^2 \le 1$．$dx\,dy=ab\, du\, dv$．因此
$$
\iint_R dx\, dy = \iint_{u^2 + v^2 \le 1} ab\, du\, dv = ab \iint_{u^2 + v^2 \le 1} du\, dv = ab \cdot \pi = \pi ab.
$$
当 $x,y$ 与 $u,v$ 之间为正比例关系时，$dx\,dy$ 与 $du\, dv$ 之间只相差一个比例系数；如果 $x,y$ 与 $u,v$ 之间的关系更复杂会怎么用？

例2：当 $u=3x-2y,v=x+y$ 时，求 $dx\,dy$ 与 $du\, dv$ 之间的关系．

由于 $u,v$ 是 $x,y$ 的线性组合，可以将 $u,v$ 写成矩阵形式：
$$
\begin{bmatrix}
u \\
v
\end{bmatrix} =
\begin{bmatrix}3 & -2 \\
1 & 1
\end{bmatrix}
\begin{bmatrix}x \\
y
\end{bmatrix}
$$
我们通过图像来观察 $dx\,dy$ 与 $du\, dv$ 之间的关系．
![](assets/file-20260224122303669.png)
根据[[#线性变换]]的知识，我们只需关注 $\hat{i},\hat{j}$ 的变化．
$$
\begin{bmatrix}3 & -2 \\
1 & 1
\end{bmatrix}
\begin{bmatrix}1 \\
0
\end{bmatrix}
=
\begin{bmatrix}3 \\
1
\end{bmatrix}, \quad
\begin{bmatrix}3 & -2 \\
1 & 1
\end{bmatrix}
\begin{bmatrix}0 \\
1
\end{bmatrix}
=
\begin{bmatrix}-2 \\
1
\end{bmatrix}
$$
变换后面积由 $\hat{i},\hat{j}$ 张成的单位正方形变为 $\begin{bmatrix}3 \\1\end{bmatrix}, \begin{bmatrix}-2 \\ 1\end{bmatrix}$ 张成的平行四边形．因此 $du\, dv$ 与 $dx\, dy$ 之间的关系为 $du\, dv =  \begin{vmatrix}3 & -2 \\
1 & 1
\end{vmatrix}  dx\, dy = 5\, dx\, dy$．

将其推广到一般情况：由估值公式
$$
\begin{cases}
\Delta u \approx u_x \Delta x + u_y \Delta y\\ \Delta v \approx v_x \Delta x + v_y \Delta y
\end{cases}
 \quad \mathrm{i.e.} \quad
\begin{bmatrix}\Delta u \\
\Delta v
\end{bmatrix} \approx
\begin{bmatrix}u_x & u_y \\
v_x & v_y
\end{bmatrix}
\begin{bmatrix}\Delta x \\
\Delta y
\end{bmatrix}
$$
取 极限 $\Delta x, \Delta y \to 0$，得到
$$
\begin{bmatrix}du \\ dv
\end{bmatrix} =
\begin{bmatrix}u_x & u_y \\
v_x & v_y
\end{bmatrix}
\begin{bmatrix}dx \\ dy
\end{bmatrix}
$$
定义 $J =\dfrac{\partial(u,v)}{\partial(x,y)}= \begin{vmatrix}u_x & u_y \\ v_x & v_y\end{vmatrix}$ 为变换的雅可比行列式(Jacobian determinant)．则有 $du\, dv = |J|\, dx\, dy$．

比如极坐标换元 $x=r\cos\theta, y=r\sin\theta$，则
$$
J = \dfrac{\partial(x,y)}{\partial(u,v)}=
\begin{vmatrix}
\cos\theta & -r\sin\theta \\
\sin\theta & r\cos\theta
\end{vmatrix}
=r(\cos^2\theta+\sin^2\theta) = r
$$
因此 $dx\,dy=|J|dr\,d\theta = rdr\,d\theta$．

### 应用

1. 计算区域 $R$ 的面积：$\mathrm{Area}=\displaystyle\iint_R 1\, dA$；亦或是将 $\delta$ 视为面密度函数 $\delta = \delta(x,y)$，则 $\mathrm{Mass}=\displaystyle\iint_R \delta\, dA$．
2. 计算给定函数在一个区域内的平均值．如 $f$ 在区域 $R$ 内的平均值为 $\displaystyle\bar{f}=\dfrac{1}{\mathrm{Area}} \iint_R f\, dA$．
3. 计算给定函数在一个区域内密度加权平均值．如 $f$ 在区域 $R$ 内的密度加权平均值为 $\displaystyle\bar{f}=\dfrac{\displaystyle\iint_R f\, \delta \, dA}{\displaystyle\iint_R\delta \, dA}  =\dfrac{1}{\mathrm{Mass}} \iint_R f\, \delta \, dA$．
   
   典型的例子就是求质心坐标：当 $f=x$ 时求的 $x$ 在 $R$ 内的密度加权平均值，即质心横坐标 $\bar{x}$；$y$ 同理．

$$
\bar{x} = \dfrac{1}{\mathrm{Mass}} \iint_R x\,\delta \,dA, \quad \bar{y} = \dfrac{1}{\mathrm{Mass}} \iint_R y\, \delta \,dA.
$$
4. 计算转动惯量(Moment of Inertia)：对于一个质点，转动惯量 $I=mr^2$；对于有多质点的系统，$I=\sum mr^2$；而对于一个连续分布的系统，其本质就是求 $r^2$ 的密度加权和，即 $I =\displaystyle \iint_R r^2\, \delta \, dA$．
> $I$ 可以理解为做旋转运动的惯性大小，类似于直线运动中的 $m$．
>
> 动能 $E_k = \dfrac{1}{2} m v^2=\dfrac{1}{2} m\omega^2r^2 = \dfrac{1}{2}I\omega^2$，其中 $\omega$ 是角速度．
>
> 角动量 $\tau = I\alpha$，其中 $\tau$ 是力矩，$\alpha$ 是角加速度．这个公式类似于直线运动中的 $F=ma$．

例1：对于半径为 $a$ 的圆盘 $x^2 + y^2 \le a^2$，其 $\delta = 1$，求其关于 $z$ 轴的转动惯量 $I_z$．
$$
I_z = \iint_R r^2\, \delta \, dA = \iint_R r^2\, dA.
$$
使用极坐标计算：
$$
I_z = \int_0^{2\pi} \int_0^a r^2 \cdot r\, dr\, d\theta = \int_0^{2\pi} d\theta \int_0^a r^3\, dr = 2\pi \cdot \frac{a^4}{4} = \frac{\pi a^4}{2}.
$$

例2：对于半径为 $a$ 的圆盘 $x^2 + y^2 \le a^2$，其 $\delta = 1$，求其关于圆周上某点的转动惯量 $I$．

![](assets/file-20260224120846159.png)
不妨将该点放在原点，而将圆盘放置在 $(x-a)^2+y^2 \le a^2$．
当 $\theta$ 固定时，$r$ 的取值范围为 $0 \le r \le 2a\cos{\theta}$；$\theta$ 的取值范围为 $-\dfrac{\pi}{2} \le \theta \le \dfrac{\pi}{2}$．因此
$$
\begin{aligned}
I &= \int_{-\frac{\pi}{2}}^{\frac{\pi}{2}} \int_0^{2a\cos{\theta}} r^2 \cdot r\, dr\, d\theta \\
&= \int_{-\frac{\pi}{2}}^{\frac{\pi}{2}} d\theta \int_0^{2a\cos{\theta}} r^3\, dr \\
&= \int_{-\frac{\pi}{2}}^{\frac{\pi}{2}} 4a^4 \cos^4{\theta} \, d\theta \\
&= 4a^4 \cdot \frac{3}{4} \cdot \frac{1}{2} \cdot \pi \\
&= \frac{3\pi a^4}{2}.
\end{aligned}
$$

## 三重积分
### 理解
$\displaystyle\iiint _RfdV$，其中 $f = f(x,y,z)$，$R$ 是 $xyz$ 空间中的一个区域，$dV$ 是体积微元．可以将 $f$ 看作体密度，三重积分的结果就是区域 $R$ 的总质量．

### 计算
#### 直角坐标
$dV = dx\, dy\, dz$，因此三重积分可以写成
$$
\iiint_R f(x,y,z)\, dV = \iiint_R f(x,y,z)\, dx\, dy\, dz.
$$
若对于给定的 $x,y$，$z$ 的取值范围为 $[z_{min}, z_{max}]$，则可以先对 $z$ 积分将三重积分化为二重积分，再用计算二重积分的方法计算．

例：计算三重积分 $\displaystyle\iiint_R xdV$，其中 $R$ 是由 $x+y+2z=2$ 和三个坐标面围成的区域．

对于给定 $x,y$，$z$ 的取值范围为 $0 \le z \le \dfrac{2-x-y}{2}$；对于给定的 $x$，$y$ 的取值范围为 $0 \le y \le 2-x$；$x$ 的取值范围为 $0 \le x \le 2$．因此
$$
\begin{aligned}
\iiint_R xdV &= \int_0^2 \int_0^{2-x} \int_0^{\frac{2-x-y}{2}} x\, dz\, dy\, dx \\
&= \int_0^2 \int_0^{2-x} \frac{2-x-y}{2}x  dy\, dx \\
&= \int_0^2 \left[\frac{x(2-x)y}{2} -\frac{xy^2}{4}  \right]_0^{2-x}dx \\
&= \frac{1}{4} \int_0^2 x(2-x)^2  dx \\
&\xlongequal{区间再现}\frac{1}{4} \int_0^2 x^2(2-x)  dx  \\
&= \frac{1}{4}\left[ \frac{2x^3}{3} - \frac{x^4}{4} \right]_0^2 \\
&= \frac{1}{3}.
\end{aligned}$$

#### 柱面坐标
将 $x,y$ 通过极坐标换元，$z$ 保持不变，即 $x=r\cos\theta, y=r\sin\theta, z=z$．则 $dV =dS\,dz= r\, dr\, d\theta\, dz$．因此三重积分可以写成
$$
\begin{aligned}
\iiint_R f(x,y,z)\, dV &= \iiint_R f(r\cos\theta, r\sin\theta, z)\, r\, dr\, d\theta\, dz \\
&= \int_{\theta_1}^{\theta_2}\int_{r_1(\theta)}^{r_2(\theta)} \int_{z_1(r,\theta)}^{z_2(r,\theta)} f(r\cos\theta, r\sin\theta, z)\, r\, dz\, dr\, d\theta
\end{aligned}
$$
例：计算三重积分 $\displaystyle\iiint_R ze^{x^2+y^2}dV$，其中 $R$ 是由 $z=2$ 和 $z=\sqrt{x^2+y^2}$ 围成的区域．

对于给定的 $x,y$，$z$ 的取值范围为 $\sqrt{x^2+y^2} \le z \le 2$，即 $r \le z \le 2$；区域 $R$ 在 $xy$ 平面上的投影是 $x^2+y^2 \le 4$，即 $0 \le r \le 2$；$\theta$ 的取值范围为 $0 \le \theta \le 2\pi$．因此
$$
\begin{aligned}
\iiint_R ze^{x^2+y^2}dV &= \int_0^{2\pi}d\theta \int_0^2 rdr\int_r^2 ze^{r^2} dz \\
&= \int_0^{2\pi}d\theta \int_0^2 re^{r^2} \cdot \frac{4-r^2}{2} dr \\
&=\frac{\pi}{2} \int_0^2 (4-r^2)e^{r^2} dr^2 \\
&=\frac{\pi}{2} \left[ (5-r^2)e^{r^2}\right]^2_0 \\
&= \frac{\pi}{2}(e^4 - 5).
\end{aligned}$$
#### 球面坐标
用 $\rho$ 表示到原点的距离，$\phi$ 表示与 $z$ 轴的夹角，$\theta$ 表示在 $xy$ 平面上的投影与 $x$ 轴的夹角．则
$$
\begin{cases}
x = \rho\sin\phi\cos\theta \\
y = \rho\sin\phi\sin\theta \\
z = \rho\cos\phi
\end{cases}
$$

![](assets/file-20260226101347270.png)
我们先无视球壳厚度，取球面上的一个面积微元；如图，长方形的长宽分别为 $\rho\sin\phi\Delta\theta$ 和 $\rho\Delta\phi$，因此面积微元 $\Delta S = \rho^2 \sin\phi \Delta\theta \Delta\phi$；再考虑球壳的厚度 $\Delta\rho$，得到体积微元 $dV = \rho^2 \sin\phi\, d\rho\, d\phi\, d\theta$．

因此
$$
\displaystyle\iiint_R f(x,y,z)\, dV = \iiint_R f(\rho\sin\phi\cos\theta,\rho\sin\phi\sin\theta,\rho\cos\phi)\, \rho^2 \sin\phi\, d\rho\, d\phi\, d\theta.
$$
### 应用
例：在原点处有一质量为 $m$ 的质点，求其与质量分布均匀均匀球体 $x^2+y^2+(z-a)^2 \le a^2$，密度为 $\delta$ 的球体的万有引力．

对于球体在 $(x,y,z)$ 处质量微元 $\Delta M$，其万有引力大小为 $|\boldsymbol{F}| = \dfrac{G\Delta M m}{\rho^2}$，方向为 $\langle\dfrac{x,y,z}{\rho}\rangle$，即 $\boldsymbol{F} = \dfrac{G\Delta M m}{\rho^2}\cdot \dfrac{\langle x,y,z\rangle}{\rho} = \dfrac{G\Delta M m}{\rho^3}\langle x,y,z\rangle$．

我们先只考虑一个分量的影响．对于 $z$ 分量，有 $\boldsymbol{F}_z = \dfrac{G\Delta M m}{\rho^3}z$．又因为 $\Delta M = \delta \Delta V$ 因此
$$
\boldsymbol{F}_z = Gm\iiint_R\frac{z}{\rho^3}\delta dV
$$
用球面坐标换元得到
$$
\begin{aligned}
\boldsymbol{F}_z &= Gm\iiint_R\frac{z}{\rho^3}\delta dV \\
&= Gm\iiint_R \frac{\rho\cos\phi}{\rho^3}\delta \cdot \rho^2 \sin\phi\, d\rho\, d\phi\, d\theta \\
&= Gm\iiint_R \delta \cdot \cos\phi \sin\phi \,d\rho \,d\phi\, d\theta \\
&=Gm\int_0^{2\pi} d\theta \int_0^{\frac{\pi}{2}} \cos\phi \sin\phi\, d\phi \int_0^{2a\cos\phi} \delta d\rho\\
&=Gm\cdot 2\pi\cdot\delta \cdot \int_0^{\frac{\pi}{2}} \cos\phi \sin\phi\, d\phi \cdot \int_0^{2a\cos\phi} d\rho\\
&=4Gm\pi a\delta \int_0^{\frac{\pi}{2}} \cos^2\phi \sin\phi\, d\phi\\
&=4Gm\pi a\delta \left[-\frac{\cos^3\phi}{3}\right]_0^{\frac{\pi}{2}}\\
&=\frac{4Gm\pi a\delta}{3}.
\end{aligned}
$$
又因为 $M=\dfrac{4}{3}\pi a^3\delta$，所以 $\boldsymbol{F}_z = \dfrac{GMm}{a^2}$．而这正是质量为 $M$ 的球体在球心处产生的万有引力大小．